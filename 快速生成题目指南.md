# å¿«é€Ÿç”Ÿæˆé¢˜ç›®æŒ‡å—

## ğŸš€ æœ€ç®€å•çš„æ–¹æ³•ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬

### å‰ææ¡ä»¶
1. åç«¯æœåŠ¡å·²å¯åŠ¨
2. å·²æœ‰æµ‹è¯•è´¦å·ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œè„šæœ¬ä¼šæç¤ºï¼‰

### æ“ä½œæ­¥éª¤
```bash
# 1. è¿›å…¥backendç›®å½•
cd backend

# 2. è¿è¡ŒFeature 3æµ‹è¯•è„šæœ¬
python test_feature3_question_gen.py
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… ç™»å½•æµ‹è¯•è´¦å·
- âœ… åˆ›å»º3é“æµ‹è¯•é”™é¢˜
- âœ… ä»é”™é¢˜ä¸­æç‚¼çŸ¥è¯†ç‚¹
- âœ… ç”Ÿæˆé¢˜ç›®ï¼ˆé€‰æ‹©é¢˜+å¡«ç©ºé¢˜ï¼‰
- âœ… æ˜¾ç¤ºç”Ÿæˆçš„é¢˜ç›®å†…å®¹

---

## ğŸ“ æ‰‹åŠ¨APIè°ƒç”¨æ–¹æ³•

### Step 1: ç™»å½•è·å–Token
```bash
# Windows PowerShell
$response = Invoke-RestMethod -Uri "http://127.0.0.1:8000/auth/login" `
  -Method Post `
  -ContentType "application/json" `
  -Body '{"username": "test_student", "password": "password123"}'

$token = $response.access_token
Write-Host "Tokenè·å–æˆåŠŸ: $token"
```

æˆ–è€…ä½¿ç”¨Postman/APIå·¥å…·ï¼š
```
POST http://127.0.0.1:8000/auth/login
Content-Type: application/json

{
  "username": "test_student",
  "password": "password123"
}

â†’ å¤åˆ¶è¿”å›çš„ access_token
```

---

### Step 2: åˆ›å»ºé”™é¢˜ï¼ˆå‡†å¤‡æ•°æ®ï¼‰
```bash
# Windows PowerShell
$headers = @{
    "Authorization" = "Bearer $token"
    "Content-Type" = "application/json"
}

$mistakeData = @{
    question_text = "è§£æ–¹ç¨‹ xÂ² - 5x + 6 = 0"
    wrong_answer = "x = 1 æˆ– x = 6"
    ai_analysis = "[MISTAKE_DETECTED] é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ x=2 æˆ– x=3"
    subject = "æ•°å­¦"
    knowledge_points = @("ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹", "å› å¼åˆ†è§£")
    difficulty = 2
} | ConvertTo-Json

$mistake = Invoke-RestMethod -Uri "http://127.0.0.1:8000/mistakes/" `
  -Method Post `
  -Headers $headers `
  -Body $mistakeData

Write-Host "é”™é¢˜ID: $($mistake.id)"
```

**æˆ–è€…åœ¨APIæ–‡æ¡£ä¸­æ“ä½œ**ï¼š
è®¿é—® http://127.0.0.1:8000/docs
â†’ æ‰¾åˆ° `POST /mistakes/`
â†’ ç‚¹å‡» "Try it out"
â†’ å¡«å…¥æ•°æ®å¹¶æ‰§è¡Œ

---

### Step 3: æç‚¼çŸ¥è¯†ç‚¹
```bash
# Windows PowerShell
$knowledgeData = @{
    mistake_ids = @(1, 2, 3)  # ä½¿ç”¨ä½ åˆ›å»ºçš„é”™é¢˜ID
    subject = "æ•°å­¦"
} | ConvertTo-Json

$knowledge = Invoke-RestMethod -Uri "http://127.0.0.1:8000/ai-learning/generate_knowledge_points" `
  -Method Post `
  -Headers $headers `
  -Body $knowledgeData

Write-Host "æç‚¼çš„çŸ¥è¯†ç‚¹:"
$knowledge.knowledge_points | ForEach-Object { Write-Host "  - $_" }
```

**APIæ–‡æ¡£æ“ä½œ**ï¼š
http://127.0.0.1:8000/docs
â†’ `POST /ai-learning/generate_knowledge_points`
â†’ ç‚¹å‡»é”å›¾æ ‡ï¼Œè¾“å…¥Bearer Token
â†’ å¡«å…¥é”™é¢˜IDå’Œå­¦ç§‘
â†’ æ‰§è¡Œ

---

### Step 4: ç”Ÿæˆé¢˜ç›® ğŸ¯
```bash
# Windows PowerShell
$questionData = @{
    knowledge_points = @("ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹", "å› å¼åˆ†è§£")
    difficulty = "ä¸­ç­‰"
    question_types = @{
        "é€‰æ‹©é¢˜" = 3
        "å¡«ç©ºé¢˜" = 2
    }
    subject = "æ•°å­¦"
} | ConvertTo-Json -Depth 3

$result = Invoke-RestMethod -Uri "http://127.0.0.1:8000/ai-learning/generate_questions" `
  -Method Post `
  -Headers $headers `
  -Body $questionData

Write-Host "âœ… ç”Ÿæˆäº† $($result.total_generated) é“é¢˜ç›®"
Write-Host "è€—æ—¶: $($result.generation_time)"
```

**APIæ–‡æ¡£æ“ä½œ**ï¼š
http://127.0.0.1:8000/docs
â†’ `POST /ai-learning/generate_questions`
â†’ å¡«å…¥ï¼š
```json
{
  "knowledge_points": ["ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹", "å› å¼åˆ†è§£"],
  "difficulty": "ä¸­ç­‰",
  "question_types": {
    "é€‰æ‹©é¢˜": 3,
    "å¡«ç©ºé¢˜": 2
  },
  "subject": "æ•°å­¦"
}
```
â†’ æ‰§è¡Œ

---

### Step 5: æŸ¥çœ‹ç”Ÿæˆçš„é¢˜ç›®
```bash
# Windows PowerShell
$questions = Invoke-RestMethod -Uri "http://127.0.0.1:8000/ai-learning/my_questions" `
  -Headers $headers

Write-Host "æˆ‘çš„é¢˜ç›®åº“å…±æœ‰ $($questions.total) é“é¢˜ç›®:"
$questions.questions | ForEach-Object {
    $content = $_.content | ConvertFrom-Json
    Write-Host ""
    Write-Host "é¢˜ç›®ç±»å‹: $($_.question_type)"
    Write-Host "é¢˜å¹²: $($content.stem)"
    Write-Host "ç­”æ¡ˆ: $($_.answer)"
}
```

---

## ğŸ¨ ä½¿ç”¨APIæ–‡æ¡£ç•Œé¢ï¼ˆæ¨èï¼‰

### æœ€ç®€å•çš„å¯è§†åŒ–æ“ä½œï¼š

1. **æ‰“å¼€APIæ–‡æ¡£**
   ```
   http://127.0.0.1:8000/docs
   ```

2. **ç™»å½•è·å–Token**
   - æ‰¾åˆ° `POST /auth/login`
   - ç‚¹å‡» "Try it out"
   - å¡«å…¥ç”¨æˆ·åå¯†ç 
   - ç‚¹å‡» "Execute"
   - å¤åˆ¶è¿”å›çš„ `access_token`

3. **æˆæƒæ‰€æœ‰æ¥å£**
   - ç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ "Authorize" æŒ‰é’®ï¼ˆğŸ”“å›¾æ ‡ï¼‰
   - è¾“å…¥ï¼š`Bearer your_token_here`
   - ç‚¹å‡» "Authorize"
   - å…³é—­å¼¹çª—

4. **åˆ›å»ºé”™é¢˜**
   - æ‰¾åˆ° `POST /mistakes/`
   - ç‚¹å‡» "Try it out"
   - å¡«å…¥é”™é¢˜æ•°æ®
   - æ‰§è¡Œå¹¶è®°ä½è¿”å›çš„ID

5. **æç‚¼çŸ¥è¯†ç‚¹**
   - æ‰¾åˆ° `POST /ai-learning/generate_knowledge_points`
   - å¡«å…¥é”™é¢˜IDåˆ—è¡¨
   - æ‰§è¡Œï¼ŒæŸ¥çœ‹AIæç‚¼çš„çŸ¥è¯†ç‚¹

6. **ç”Ÿæˆé¢˜ç›®**
   - æ‰¾åˆ° `POST /ai-learning/generate_questions`
   - å¡«å…¥çŸ¥è¯†ç‚¹ã€éš¾åº¦ã€é¢˜å‹
   - æ‰§è¡Œï¼Œç­‰å¾…AIç”Ÿæˆï¼ˆ10-30ç§’ï¼‰

7. **æŸ¥çœ‹é¢˜ç›®**
   - æ‰¾åˆ° `GET /ai-learning/my_questions`
   - æ‰§è¡Œï¼ŒæŸ¥çœ‹æ‰€æœ‰ç”Ÿæˆçš„é¢˜ç›®

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: 401 Unauthorized
**åŸå› **ï¼šTokenè¿‡æœŸæˆ–æœªæˆæƒ

**è§£å†³**ï¼š
1. é‡æ–°ç™»å½•è·å–Token
2. åœ¨APIæ–‡æ¡£ä¸­ç‚¹å‡»"Authorize"é‡æ–°æˆæƒ

### Q2: 404 Not Found (é”™é¢˜æˆ–é¢˜ç›®)
**åŸå› **ï¼šIDä¸å­˜åœ¨æˆ–å±äºå…¶ä»–ç”¨æˆ·

**è§£å†³**ï¼š
1. ä½¿ç”¨ `GET /mistakes/` æŸ¥çœ‹è‡ªå·±çš„é”™é¢˜ID
2. ä½¿ç”¨ `GET /ai-learning/my_questions` æŸ¥çœ‹è‡ªå·±çš„é¢˜ç›®

### Q3: 500 Internal Server Error
**åŸå› **ï¼šé€šä¹‰åƒé—®APIè°ƒç”¨å¤±è´¥

**è§£å†³**ï¼š
1. æ£€æŸ¥åç«¯æ—¥å¿—
2. ç¡®è®¤DASHSCOPE_API_KEYé…ç½®æ­£ç¡®
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

### Q4: ç”Ÿæˆé¢˜ç›®å¾ˆæ…¢
**åŸå› **ï¼šAIç”Ÿæˆéœ€è¦æ—¶é—´

**é¢„æœŸè€—æ—¶**ï¼š
- æç‚¼çŸ¥è¯†ç‚¹ï¼š3-5ç§’
- ç”Ÿæˆ2é“é€‰æ‹©é¢˜ï¼š8-12ç§’
- ç”Ÿæˆ5é“é¢˜ï¼ˆæ··åˆï¼‰ï¼š20-30ç§’

---

## ğŸ“Š å®Œæ•´ç¤ºä¾‹æ•°æ®

### é”™é¢˜æ•°æ®ç¤ºä¾‹
```json
{
  "question_text": "æ±‚å¯¼æ•° f(x) = xÂ³ + 2x",
  "wrong_answer": "f'(x) = xÂ² + 2",
  "ai_analysis": "[MISTAKE_DETECTED] é”™è¯¯ï¼xÂ³çš„å¯¼æ•°æ˜¯3xÂ²ï¼Œä¸æ˜¯xÂ²ã€‚æ­£ç¡®ç­”æ¡ˆæ˜¯ f'(x) = 3xÂ² + 2",
  "subject": "æ•°å­¦",
  "knowledge_points": ["å¯¼æ•°", "å¹‚å‡½æ•°æ±‚å¯¼"],
  "difficulty": 3
}
```

### ç”Ÿæˆé¢˜ç›®è¯·æ±‚ç¤ºä¾‹
```json
{
  "knowledge_points": ["å¯¼æ•°", "å¹‚å‡½æ•°æ±‚å¯¼"],
  "difficulty": "ä¸­ç­‰",
  "question_types": {
    "é€‰æ‹©é¢˜": 2,
    "å¡«ç©ºé¢˜": 1,
    "è§£ç­”é¢˜": 1
  },
  "subject": "æ•°å­¦"
}
```

---

## ğŸ¯ å¿«é€Ÿæµ‹è¯•å‘½ä»¤ï¼ˆå¤åˆ¶å³ç”¨ï¼‰

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•
cd backend
python test_feature3_question_gen.py

# æˆ–è€…åˆ†æ­¥è¿è¡Œæµ‹è¯•
python test_feature1_auth.py      # Feature 1: åˆ›å»ºç”¨æˆ·
python test_feature2_mistakes.py  # Feature 2: åˆ›å»ºé”™é¢˜
python test_feature3_question_gen.py  # Feature 3: ç”Ÿæˆé¢˜ç›®
```

---

**æ¨èæ–¹å¼**ï¼šå…ˆè¿è¡Œæµ‹è¯•è„šæœ¬çœ‹æ•ˆæœï¼Œç†Ÿæ‚‰æµç¨‹åå†ç”¨APIæ‰‹åŠ¨æ“ä½œï¼

**APIæ–‡æ¡£åœ°å€**ï¼šhttp://127.0.0.1:8000/docs ğŸ“š

