# APIæ¥å£å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸš€ 3åˆ†é’Ÿä¸Šæ‰‹

### æ­¥éª¤1ï¼šå¯åŠ¨æœåŠ¡

```bash
cd backend
uvicorn main:app --reload
```

çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºè¯´æ˜æˆåŠŸï¼š
```
âœ… ç»Ÿä¸€æ™ºèƒ½APIè·¯ç”±å·²åŠ è½½: /api/solve, /api/question_bank
INFO:     Uvicorn running on http://127.0.0.1:8000
```

### æ­¥éª¤2ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬

```bash
python test_api.py
```

### æ­¥éª¤3ï¼šæŸ¥çœ‹APIæ–‡æ¡£

æµè§ˆå™¨æ‰“å¼€ï¼šhttp://127.0.0.1:8000/docs

---

## ğŸ“‹ æ¥å£åŠŸèƒ½å¯¹ç…§è¡¨

æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œæ‰€æœ‰åŠŸèƒ½å·²å®ç°ï¼š

| **åŠŸèƒ½éœ€æ±‚** | **APIè°ƒç”¨** | **ç¤ºä¾‹** |
|------------|------------|---------|
| å‘é€ä¸€é“é¢˜ç›®çš„å›¾ç‰‡ä¿¡æ¯ â†’ è¿”å›é¢˜ç›®è§£æç»“æœ | `POST /api/solve` | `{"mode":"solve","content":{"image_base64":"..."}}` |
| å‘é€ä¸€é“é¢˜ç›®çš„æ–‡å­—ä¿¡æ¯ â†’ è¿”å›é¢˜ç›®è§£æç»“æœ | `POST /api/solve` | `{"mode":"solve","content":{"text":"æ±‚1+1"}}` |
| å‘é€å¤šé“é¢˜ç›®çš„å›¾ç‰‡ä¿¡æ¯ â†’ è¿”å›é¢˜ç›®è§£æç»“æœ | `POST /api/solve` | `{"mode":"solve","question_count":"multiple","content":{"image_base64":"..."}}` |
| å‘é€å¤šé“é¢˜ç›®çš„æ–‡å­—ä¿¡æ¯ â†’ è¿”å›é¢˜ç›®è§£æç»“æœ | `POST /api/solve` | `{"mode":"solve","content":{"text":"ç¬¬1é¢˜...ç¬¬2é¢˜..."}}` |
| å‘é€å¸¦æœ‰ç»“æœä¸€é“é¢˜ç›®çš„å›¾ç‰‡ä¿¡æ¯ â†’ è¿”å›é¢˜ç›®æ‰¹æ”¹ç»“æœ | `POST /api/solve` | `{"mode":"review","content":{"image_base64":"..."}}` |
| å‘é€å¸¦æœ‰ç»“æœä¸€é“é¢˜ç›®çš„æ–‡å­—ä¿¡æ¯ â†’ è¿”å›é¢˜ç›®æ‰¹æ”¹ç»“æœ | `POST /api/solve` | `{"mode":"review","content":{"text":"é¢˜ç›®+ç­”æ¡ˆ"}}` |
| å‘é€å¸¦æœ‰ç»“æœå¤šé“é¢˜ç›®çš„å›¾ç‰‡ä¿¡æ¯ â†’ è¿”å›é¢˜ç›®æ‰¹æ”¹ç»“æœ | `POST /api/solve` | `{"mode":"review","question_count":"multiple","content":{"image_base64":"..."}}` |
| å‘é€å¸¦æœ‰ç»“æœå¤šé“é¢˜ç›®çš„æ–‡å­—ä¿¡æ¯ â†’ è¿”å›é¢˜ç›®æ‰¹æ”¹ç»“æœ | `POST /api/solve` | `{"mode":"review","content":{"text":"å¤šé“é¢˜+ç­”æ¡ˆ"}}` |
| å‘é€çŸ¥è¯†ç‚¹æ ‡ç­¾ç­‰ â†’ è¿”å›é¢˜åº“è¯•é¢˜ | `POST /api/question_bank` | `{"tags":["å‡½æ•°","å¯¼æ•°"],"limit":10}` |

---

## ğŸ’» ä»£ç ç¤ºä¾‹

### Pythonè°ƒç”¨

```python
import requests
import base64

# æ–‡å­—è§£é¢˜
response = requests.post('http://127.0.0.1:8000/api/solve', json={
    'mode': 'solve',
    'content': {'text': 'æ±‚ f(x) = x^2 çš„å¯¼æ•°'}
})
print(response.json()['results'][0]['answer']['content'])

# å›¾ç‰‡è§£é¢˜
with open('question.png', 'rb') as f:
    img_base64 = base64.b64encode(f.read()).decode()

response = requests.post('http://127.0.0.1:8000/api/solve', json={
    'mode': 'solve',
    'content': {'image_base64': img_base64}
})
print(response.json())
```

### cURLæµ‹è¯•

```bash
# æ–‡å­—è§£é¢˜
curl -X POST http://127.0.0.1:8000/api/solve \
  -H "Content-Type: application/json" \
  -d '{"mode":"solve","content":{"text":"æ±‚1+1çš„å€¼"}}'

# æ–‡å­—æ‰¹æ”¹
curl -X POST http://127.0.0.1:8000/api/solve \
  -H "Content-Type: application/json" \
  -d '{"mode":"review","content":{"text":"é¢˜ç›®ï¼š1+1=? ç­”æ¡ˆï¼š3"}}'

# é¢˜åº“æ£€ç´¢
curl -X POST http://127.0.0.1:8000/api/question_bank \
  -H "Content-Type: application/json" \
  -d '{"tags":["å‡½æ•°","å¯¼æ•°"],"limit":5}'
```

---

## ğŸ“š å®Œæ•´æ–‡æ¡£

- **è¯¦ç»†APIæ–‡æ¡£**ï¼š[APIæ¥å£ä½¿ç”¨æŒ‡å—.md](./APIæ¥å£ä½¿ç”¨æŒ‡å—.md)
- **åœ¨çº¿æ–‡æ¡£**ï¼šhttp://127.0.0.1:8000/docs
- **æµ‹è¯•è„šæœ¬**ï¼š`python backend/test_api.py`

---

## âœ… æ–‡ä»¶æ¸…å•

```
backend/
  â”œâ”€â”€ api_routes.py          ã€æ–°å¢ã€‘ç»Ÿä¸€æ™ºèƒ½APIå®ç°
  â”œâ”€â”€ test_api.py            ã€æ–°å¢ã€‘APIæµ‹è¯•è„šæœ¬
  â””â”€â”€ main.py                ã€å·²ä¿®æ”¹ã€‘é›†æˆAPIè·¯ç”±

æ ¹ç›®å½•/
  â”œâ”€â”€ APIæ¥å£ä½¿ç”¨æŒ‡å—.md       ã€æ–°å¢ã€‘å®Œæ•´APIæ–‡æ¡£
  â””â”€â”€ APIå¿«é€Ÿå¯åŠ¨æŒ‡å—.md       ã€æ–°å¢ã€‘æœ¬æ–‡ä»¶
```

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

âœ… **ç»Ÿä¸€æ¥å£**ï¼šä¸€ä¸ª `/api/solve` å¤„ç†8ç§åŠŸèƒ½  
âœ… **è‡ªåŠ¨è¯†åˆ«**ï¼šè¾“å…¥ç±»å‹å’Œé¢˜ç›®æ•°é‡è‡ªåŠ¨æ£€æµ‹  
âœ… **çµæ´»é…ç½®**ï¼šæ”¯æŒå¤šç§è¯¦ç»†ç¨‹åº¦å’Œé€‰é¡¹  
âœ… **å®Œæ•´æ–‡æ¡£**ï¼šè‡ªåŠ¨ç”ŸæˆSwaggeræ–‡æ¡£  
âœ… **æ˜“äºæµ‹è¯•**ï¼šæä¾›æµ‹è¯•è„šæœ¬å’Œç¤ºä¾‹  

---

## ğŸ’¡ æç¤º

1. æ‰€æœ‰åŠŸèƒ½å·²æŒ‰æ‚¨çš„éœ€æ±‚è¡¨ç»Ÿä¸€åˆ° `/api/solve` æ¥å£
2. é€šè¿‡ `mode` å‚æ•°åŒºåˆ†è§£é¢˜(solve)å’Œæ‰¹æ”¹(review)
3. æ”¯æŒå›¾ç‰‡å’Œæ–‡å­—ä¸¤ç§è¾“å…¥æ–¹å¼
4. è‡ªåŠ¨æ£€æµ‹å•é¢˜è¿˜æ˜¯å¤šé¢˜
5. é¢˜åº“æ£€ç´¢ä½¿ç”¨ç‹¬ç«‹çš„ `/api/question_bank` æ¥å£

---

**ğŸ‰ ç°åœ¨å¼€å§‹ä½¿ç”¨è¿™å¥—å¼ºå¤§çš„APIæ¥å£å§ï¼**

