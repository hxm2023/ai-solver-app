# 沐梧AI解题系统 - 快速开始指南

## 📋 目录
- [初次部署（首次使用）](#-初次部署首次使用)
- [重复打开（第二次及以后）](#-重复打开第二次及以后)
- [访问地址说明](#-访问地址说明)
- [常见问题](#-常见问题)

---

## 🎯 初次部署（首次使用）

### 前置条件检查

确保已安装：
- ✅ Python 3.9 - 3.13
- ✅ Node.js 16.x 或更高
- ✅ 稳定的网络连接

---

### 方式一：一键部署（Windows推荐）⭐

#### 第1步：获取API Key

1. 访问 [阿里云百炼平台](https://bailian.console.aliyun.com/)
2. 登录/注册阿里云账号
3. 创建应用并获取API Key
4. 复制API Key备用

#### 第2步：配置API Key

在项目的 `backend/` 目录下：
1. 新建文本文件
2. 命名为 `.env`（注意开头有点）
3. 内容填写：
   ```
   DASHSCOPE_API_KEY=sk-xxxxxxxxxxxxxxxxxxxx
   ```
4. 保存文件

> 💡 **提示**：Windows下直接重命名为`.env`可能失败，可以用记事本"另存为"，文件名输入`.env`，文件类型选"所有文件"

#### 第3步：一键启动

双击运行：
```
【启动】简化版错题本系统.bat
```

**首次运行会自动**：
- 创建Python虚拟环境
- 安装后端依赖（约5-10分钟）
- 安装前端依赖（约2-5分钟）
- 启动后端和前端服务

**等待看到**：
```
✅ 后端服务已启动: http://127.0.0.1:8000
✅ 前端服务已启动: http://localhost:5173
```

#### 第4步：访问应用

打开浏览器，访问：
```
http://localhost:5173/?mode=old
```

**看到模式选择页面**：
- 🧠 AI智能解题
- 📝 AI批改作业

说明启动成功！🎉

---

### 方式二：手动部署（所有平台）

#### 第1步：配置API Key

**Windows**:
```bash
cd backend
echo DASHSCOPE_API_KEY=sk-xxxxxxxxxxxxxxxxxxxx > .env
```

**macOS/Linux**:
```bash
cd backend
echo "DASHSCOPE_API_KEY=sk-xxxxxxxxxxxxxxxxxxxx" > .env
```

#### 第2步：安装后端依赖

```bash
cd backend
python -m venv venv                    # 创建虚拟环境

# Windows:
.\venv\Scripts\activate

# macOS/Linux:
source venv/bin/activate

pip install -r requirements.txt        # 安装依赖（约5-10分钟）
```

**预期输出**：
```
Successfully installed fastapi-x.x.x uvicorn-x.x.x ...
```

#### 第3步：安装前端依赖

```bash
cd frontend/vite-project
npm install                            # 安装依赖（约2-5分钟）
```

**预期输出**：
```
added xxx packages in xxs
```

#### 第4步：启动后端服务

**打开第一个终端**：
```bash
cd backend
.\venv\Scripts\activate                # Windows
# source venv/bin/activate             # macOS/Linux

uvicorn main_simple:app --reload --host 0.0.0.0 --port 8000
```

**预期输出**：
```
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process
```

#### 第5步：启动前端服务

**打开第二个终端**：
```bash
cd frontend/vite-project
npm run dev
```

**预期输出**：
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
```

#### 第6步：访问应用

浏览器打开：
```
http://localhost:5173/?mode=old
```

---

## 🔄 重复打开（第二次及以后）

### Windows用户（最简单）

**只需两步**：

1. 双击运行：`【启动】简化版错题本系统.bat`
2. 浏览器访问：`http://localhost:5173/?mode=old`

**说明**：
- ✅ 不会重新安装依赖（秒启动）
- ✅ 自动启动前后端服务
- ✅ 关闭命令行窗口即停止服务

---

### 手动启动（所有平台）

#### 使用启动脚本（推荐）

**Windows**:
```bash
【启动】简化版错题本系统.bat
```

**macOS/Linux**:
```bash
# 如果有启动脚本
./start.sh

# 如果没有，参考下面的手动方式
```

#### 完全手动启动

**终端1 - 启动后端**:
```bash
cd backend
.\venv\Scripts\activate                # Windows
# source venv/bin/activate             # macOS/Linux
uvicorn main_simple:app --reload --host 0.0.0.0 --port 8000
```

**终端2 - 启动前端**:
```bash
cd frontend/vite-project
npm run dev
```

**浏览器访问**:
```
http://localhost:5173/?mode=old
```

---

## 🌐 访问地址说明

### 主要界面

| 地址 | 功能 | 推荐度 |
|------|------|--------|
| **http://localhost:5173/?mode=old** | 解题+批改界面 | ⭐⭐⭐⭐⭐ |
| http://localhost:5173 | 错题本+出题界面 | ⭐⭐⭐⭐ |
| http://127.0.0.1:8000/docs | 后端API文档 | ⭐⭐⭐ |

### 推荐使用流程

```
1. 访问 http://localhost:5173/?mode=old
2. 选择功能：
   - 🧠 AI智能解题 → 上传题目图片 → 获取详细解答
   - 📝 AI批改作业 → 上传题目+答案 → 自动批改+保存错题
3. 如需管理错题或生成练习：
   - 访问 http://localhost:5173
   - 使用智能错题本和AI出题功能
```

---

## ❓ 常见问题

### Q1: 首次安装很慢怎么办？

**A**: 正常现象，请耐心等待

**原因**：
- Python依赖包较大（Pix2Text约500MB，OpenCV约200MB）
- 需要下载和编译

**预计时间**：
- 后端依赖：5-10分钟
- 前端依赖：2-5分钟

**加速方法**：
```bash
# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
npm config set registry https://registry.npmmirror.com
```

---

### Q2: 端口被占用怎么办？

**A**: 修改端口配置

**后端（8000端口被占用）**:
```bash
# 使用其他端口
uvicorn main_simple:app --reload --port 8001

# 同时修改前端API地址
# 编辑 frontend/vite-project/src/SimpleMistakeBook.tsx
# 将 const API_BASE_URL = 'http://127.0.0.1:8000';
# 改为 const API_BASE_URL = 'http://127.0.0.1:8001';
```

**前端（5173端口被占用）**:
- Vite会自动选择下一个可用端口（5174, 5175...）
- 注意使用实际端口访问

---

### Q3: 虚拟环境激活失败？

**A**: Windows PowerShell权限问题

**错误提示**：
```
无法加载文件 xxx\activate.ps1，因为在此系统上禁止运行脚本
```

**解决方法**：
```powershell
# 以管理员身份运行PowerShell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

或者**改用命令提示符（CMD）**：
```cmd
cd backend
venv\Scripts\activate.bat
```

---

### Q4: 找不到 .env 文件？

**A**: 创建方法

**方法1（推荐）**：
1. 用记事本新建文本文件
2. 内容填写：`DASHSCOPE_API_KEY=your_key_here`
3. 另存为：文件名输入 `.env`，保存类型选"所有文件"
4. 保存到 `backend/` 目录

**方法2（命令行）**：
```bash
cd backend
echo DASHSCOPE_API_KEY=your_key_here > .env
```

**验证**：
```bash
# Windows
type backend\.env

# macOS/Linux  
cat backend/.env

# 应该显示：
DASHSCOPE_API_KEY=sk-xxxxxxxxxxxxxxxxxxxx
```

---

### Q5: 依赖安装失败？

**A**: 常见原因和解决方法

**原因1：网络问题**
```bash
# 使用国内镜像
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

**原因2：Python版本不兼容**
```bash
# 检查Python版本
python --version

# 应该是 3.9 - 3.13
# 如果不是，请安装正确版本
```

**原因3：权限不足**
```bash
# Windows: 以管理员身份运行命令提示符
# macOS/Linux: 使用 sudo（不推荐在虚拟环境中）
```

---

### Q6: 页面打不开或白屏？

**A**: 检查清单

- [ ] 后端服务是否正常启动？
  - 查看终端是否有 `Uvicorn running on...`
  - 访问 http://127.0.0.1:8000 是否有响应

- [ ] 前端服务是否正常启动？
  - 查看终端是否有 `Local: http://localhost:5173/`
  
- [ ] 是否使用了正确的URL？
  - 应该是 `http://localhost:5173/?mode=old`
  - 注意有 `?mode=old` 参数

- [ ] 浏览器控制台是否有错误？
  - 按F12打开开发者工具
  - 查看Console和Network标签

---

### Q7: API Key无效？

**A**: 检查和验证

**检查1：Key是否正确**
```bash
# 查看.env文件
type backend\.env

# 确认格式：
DASHSCOPE_API_KEY=sk-xxxxxxxxxxxxxxxxxxxx
# 注意：等号两边不要有空格
```

**检查2：Key是否有效**
- 访问[阿里云控制台](https://bailian.console.aliyun.com/)
- 确认API Key状态为"启用"
- 确认有足够的调用额度

**检查3：重启服务**
```bash
# 修改.env后需要重启后端服务
# Ctrl+C 停止
# 重新运行 uvicorn main_simple:app --reload ...
```

---

## 🎉 启动成功的标志

### 后端启动成功

终端显示：
```
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [xxxxx]
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

### 前端启动成功

终端显示：
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
  ➜  press h to show help
```

### 页面访问成功

浏览器显示：
```
┌─────────────────────┐
│  请选择功能模式      │
│                     │
│  🧠 AI智能解题      │
│  📝 AI批改作业      │
└─────────────────────┘
```

---

## 📞 获取帮助

如果以上方法都无法解决问题，请：

1. **查看详细文档**：
   - `README.md` - 项目总览
   - `沐梧AI解题系统_技术文档.md` - 完整技术文档

2. **查看错误日志**：
   - 后端错误：查看后端终端输出
   - 前端错误：F12打开浏览器控制台

3. **检查系统状态**：
   - 后端：访问 http://127.0.0.1:8000
   - API文档：访问 http://127.0.0.1:8000/docs

---

## ✅ 检查清单

使用前请确认：

- [ ] Python版本正确（3.9-3.13）
- [ ] Node.js已安装（16.x+）
- [ ] API Key已配置到 `backend/.env`
- [ ] 后端依赖已安装
- [ ] 前端依赖已安装
- [ ] 后端服务已启动（8000端口）
- [ ] 前端服务已启动（5173端口）
- [ ] 浏览器访问 `http://localhost:5173/?mode=old`

---

<div align="center">

**🎉 祝使用愉快！**

如有问题，请参考 [【必看】V24.5白屏调试指南.md](【必看】V24.5白屏调试指南.md)

</div>

