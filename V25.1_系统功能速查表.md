# ğŸ“‹ V25.1 ç³»ç»ŸåŠŸèƒ½é€ŸæŸ¥è¡¨

## ğŸ¯ å¿«é€Ÿå¯¼èˆª

| åŠŸèƒ½æ¨¡å— | JSONç‰ˆæœ¬ | æ•°æ®åº“ç‰ˆæœ¬ | è¯´æ˜ |
|---------|---------|-----------|------|
| è®¿é—®åœ°å€ | http://localhost:5173/ | http://localhost:5173/?mode=db | URLå‚æ•°åŒºåˆ† |
| ç”¨æˆ·è®¤è¯ | âŒ | âœ… | æ•°æ®åº“ç‰ˆéœ€è¦ç™»å½• |
| é”™é¢˜ç®¡ç† | âœ… | âœ… | ä¸¤ç‰ˆæœ¬éƒ½æ”¯æŒ |
| æ™ºèƒ½å‡ºé¢˜ | âœ… | â³ | æ•°æ®åº“ç‰ˆå¼€å‘ä¸­ |
| PDFå¯¼å‡º | âœ… | â³ | æ•°æ®åº“ç‰ˆå¼€å‘ä¸­ |
| ç½‘ç»œè¾…åŠ©å‡ºé¢˜ | âœ… | â³ | æ•°æ®åº“ç‰ˆå¼€å‘ä¸­ |
| å¤šç”¨æˆ·æ”¯æŒ | âŒ | âœ… | æ•°æ®åº“ç‰ˆæ ¸å¿ƒä¼˜åŠ¿ |
| æ•°æ®æŒä¹…åŒ– | ğŸ“„ JSON | ğŸ—„ï¸ MySQL | æ•°æ®åº“æ›´å®‰å…¨ |

---

## ğŸ”— ç³»ç»Ÿç«¯ç‚¹é€ŸæŸ¥

### å‰ç«¯è®¿é—®åœ°å€

| æ¨¡å¼ | URL | è¯´æ˜ |
|-----|-----|------|
| JSONç‰ˆæœ¬ | http://localhost:5173/ | é»˜è®¤ï¼Œæ— éœ€ç™»å½• |
| æ•°æ®åº“ç‰ˆæœ¬ | http://localhost:5173/?mode=db | éœ€è¦ç™»å½• |
| æ—§ç‰ˆç•Œé¢ | http://localhost:5173/?mode=old | åŸè§£é¢˜ç•Œé¢ |
| å¸¦ç™»å½•ç•Œé¢ | http://localhost:5173/?mode=new | MainAppç»„ä»¶ |

### åç«¯APIåœ°å€

| æœåŠ¡ | ç«¯å£ | æ–‡æ¡£åœ°å€ |
|-----|------|---------|
| JSONç‰ˆæœ¬åç«¯ | 8000 | http://127.0.0.1:8000/docs |
| æ•°æ®åº“ç‰ˆæœ¬åç«¯ | 8000 | http://127.0.0.1:8000/docs |

**æ³¨æ„ï¼š** ä¸¤ä¸ªåç«¯å…±ç”¨åŒä¸€ç«¯å£ï¼Œéœ€è¦æ ¹æ®å¯åŠ¨è„šæœ¬é€‰æ‹©ï¼š
- `ã€å¯åŠ¨ã€‘ç®€åŒ–ç‰ˆé”™é¢˜æœ¬ç³»ç»Ÿ.bat` â†’ JSONç‰ˆæœ¬ï¼ˆmain_simple.pyï¼‰
- `ã€å¯åŠ¨ã€‘æ•°æ®åº“ç‰ˆæœ¬ç³»ç»Ÿ.bat` â†’ æ•°æ®åº“ç‰ˆæœ¬ï¼ˆmain_db.pyï¼‰

---

## ğŸ—„ï¸ æ•°æ®åº“è¿æ¥ä¿¡æ¯

```python
HOST = "14.103.127.20"
PORT = 3306
USER = "root"
PASSWORD = "Jiuzhi#2024"
DATABASE = "edu"
```

**Navicatè¿æ¥æ­¥éª¤ï¼š**
1. æ–°å»ºMySQLè¿æ¥
2. å¡«å…¥ä¸Šè¿°ä¿¡æ¯
3. ç‚¹å‡»"æµ‹è¯•è¿æ¥"
4. è¿æ¥æˆåŠŸåå¯æŸ¥çœ‹è¡¨ç»“æ„å’Œæ•°æ®

---

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### userè¡¨ï¼ˆç”¨æˆ·è¡¨ï¼‰
```sql
ä¸»é”®ï¼šuser_id (VARCHAR 100)
å­—æ®µï¼š
  - account (VARCHAR 50) - è´¦å·
  - password_hash (VARCHAR 256) - å¯†ç å“ˆå¸Œ
  - nickname (VARCHAR 50) - æ˜µç§°
  - created_at (DATETIME) - æ³¨å†Œæ—¶é—´
```

### examè¡¨ï¼ˆè¯•å·è¡¨ï¼‰
```sql
ä¸»é”®ï¼šexam_id (VARCHAR 100)
å­—æ®µï¼š
  - exam_title (VARCHAR 100) - æ ‡é¢˜
  - exam_content (TEXT) - å†…å®¹
  - exam_type (VARCHAR 50) - ç±»å‹ï¼ˆmistake_book/practice_set/customï¼‰
  - created_at (DATETIME) - åˆ›å»ºæ—¶é—´
```

### subjectè¡¨ï¼ˆé¢˜ç›®è¡¨ï¼‰
```sql
ä¸»é”®ï¼šsubject_id (VARCHAR 100)
å­—æ®µï¼š
  - subject_title (LONGTEXT) - é¢˜ç›®å†…å®¹
  - subject_desc (LONGTEXT) - æè¿°
  - image_url (TEXT) - å›¾ç‰‡URL/Base64
  - solve (LONGTEXT) - è§£ç­”
  - subject_type (VARCHAR 50) - ç±»å‹ï¼ˆmistake/generatedï¼‰
  - difficulty (VARCHAR 20) - éš¾åº¦
  - knowledge_points (TEXT) - çŸ¥è¯†ç‚¹JSON
  - subject_name (VARCHAR 50) - å­¦ç§‘
  - grade (VARCHAR 20) - å¹´çº§
  - answer (LONGTEXT) - ç­”æ¡ˆ
  - explanation (LONGTEXT) - è§£æ
  - created_at/updated_at (DATETIME) - æ—¶é—´æˆ³
```

### user_examè¡¨ï¼ˆç”¨æˆ·ç­”é¢˜è®°å½•ï¼‰
```sql
ä¸»é”®ï¼šid (VARCHAR 100)
å­—æ®µï¼š
  - user_info (VARCHAR 100) - ç”¨æˆ·ID
  - subject_id (VARCHAR 100) - é¢˜ç›®ID
  - exam_id (VARCHAR 100) - è¯•å·ID
  - answered_at (DATETIME) - ç­”é¢˜æ—¶é—´
  - user_answer (TEXT) - ç”¨æˆ·ç­”æ¡ˆ
  - status (VARCHAR 20) - çŠ¶æ€ï¼ˆunanswered/correct/incorrectï¼‰
```

---

## ğŸ” APIè®¤è¯ç«¯ç‚¹

### ç”¨æˆ·æ³¨å†Œ
```http
POST /auth/register
Content-Type: application/json

{
  "account": "username",
  "password": "password123",
  "nickname": "æ˜µç§°"
}

å“åº”ï¼š
{
  "success": true,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "user_id": "uuid"
}
```

### ç”¨æˆ·ç™»å½•
```http
POST /auth/login
Content-Type: application/json

{
  "account": "username",
  "password": "password123"
}

å“åº”ï¼š
{
  "access_token": "eyJ...",
  "token_type": "bearer",
  "user_info": {
    "user_id": "uuid",
    "account": "username",
    "nickname": "æ˜µç§°"
  }
}
```

### éªŒè¯ä»¤ç‰Œ
```http
GET /auth/verify
Authorization: Bearer eyJ...

å“åº”ï¼š
{
  "valid": true,
  "user_info": {...}
}
```

### è·å–å½“å‰ç”¨æˆ·
```http
GET /auth/me
Authorization: Bearer eyJ...

å“åº”ï¼š
{
  "user_id": "uuid",
  "account": "username",
  "nickname": "æ˜µç§°",
  "created_at": "2025-10-25T..."
}
```

---

## ğŸ“ é”™é¢˜æœ¬API

### è·å–é”™é¢˜åˆ—è¡¨
```http
GET /mistakes/?subject=æ•°å­¦&grade=é«˜ä¸€&limit=10&offset=0
Authorization: Bearer eyJ...

å“åº”ï¼š
{
  "total": 5,
  "items": [
    {
      "id": "uuid",
      "question_text": "...",
      "wrong_answer": "...",
      "ai_analysis": "...",
      "subject": "æ•°å­¦",
      "grade": "é«˜ä¸€",
      "knowledge_points": ["..."],
      "created_at": "2025-10-25T..."
    }
  ],
  "offset": 0,
  "limit": 10
}
```

### åˆ›å»ºé”™é¢˜
```http
POST /mistakes/
Authorization: Bearer eyJ...
Content-Type: application/json

{
  "image_base64": "iVBORw0KG...",
  "question_text": "...",
  "wrong_answer": "...",
  "ai_analysis": "...",
  "subject": "æ•°å­¦",
  "grade": "é«˜ä¸€",
  "knowledge_points": ["ä¸ç­‰å¼", "å‡½æ•°"]
}
```

### åˆ é™¤é”™é¢˜
```http
DELETE /mistakes/{mistake_id}
Authorization: Bearer eyJ...

å“åº”ï¼š
{
  "success": true,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

### è·å–ç»Ÿè®¡ä¿¡æ¯
```http
GET /mistakes/stats/summary
Authorization: Bearer eyJ...

å“åº”ï¼š
{
  "total_mistakes": 5,
  "subjects": {
    "æ•°å­¦": 3,
    "è‹±è¯­": 2
  },
  "grades": {
    "é«˜ä¸€": 3,
    "é«˜äºŒ": 2
  },
  "top_knowledge_points": [
    ["ä¸ç­‰å¼", 2],
    ["å‡½æ•°", 1]
  ]
}
```

---

## ğŸ“š é¢˜ç›®åº“API

### è·å–é¢˜ç›®åˆ—è¡¨
```http
GET /questions/?subject=æ•°å­¦&grade=é«˜ä¸€&limit=10&offset=0
Authorization: Bearer eyJ...
```

### ç”Ÿæˆé¢˜ç›®
```http
POST /questions/generate
Authorization: Bearer eyJ...
Content-Type: application/json

{
  "mistake_ids": ["uuid1", "uuid2"],
  "count": 3,
  "difficulty": "ä¸­ç­‰",
  "allow_web_search": false
}
```

### åˆ é™¤é¢˜ç›®
```http
DELETE /questions/{question_id}
Authorization: Bearer eyJ...
```

---

## ğŸ¨ å‰ç«¯ç»„ä»¶ç»“æ„

```
src/
â”œâ”€â”€ SimpleMistakeBook.tsx          # JSONç‰ˆæœ¬ä¸»ç•Œé¢
â”œâ”€â”€ SimpleMistakeBookDB.tsx        # æ•°æ®åº“ç‰ˆæœ¬ä¸»ç•Œé¢ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ SimpleMistakeBook.css          # é€šç”¨æ ·å¼
â”œâ”€â”€ SimpleMistakeBookDB.css        # æ•°æ®åº“ç‰ˆæœ¬æ ·å¼ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ QuestionItem.tsx           # é¢˜ç›®æ¸²æŸ“ç»„ä»¶ï¼ˆLaTeXæ”¯æŒï¼‰
â”‚   â”œâ”€â”€ AuthModal.tsx              # ç™»å½•/æ³¨å†Œæ¨¡æ€æ¡†ï¼ˆæ–°å¢ï¼‰
â”‚   â””â”€â”€ AuthModal.css              # è®¤è¯ç»„ä»¶æ ·å¼ï¼ˆæ–°å¢ï¼‰
â””â”€â”€ utils/
    â””â”€â”€ api.ts                     # APIè¯·æ±‚å·¥å…·ï¼ˆæ–°å¢ï¼‰
```

---

## ğŸ› ï¸ å¯åŠ¨è„šæœ¬ä¸€è§ˆ

| è„šæœ¬åç§° | åŠŸèƒ½ | åç«¯æ–‡ä»¶ |
|---------|------|---------|
| ã€å¯åŠ¨ã€‘ç®€åŒ–ç‰ˆé”™é¢˜æœ¬ç³»ç»Ÿ.bat | JSONç‰ˆæœ¬ | main_simple.py |
| ã€å¯åŠ¨ã€‘æ•°æ®åº“ç‰ˆæœ¬ç³»ç»Ÿ.bat | æ•°æ®åº“ç‰ˆæœ¬ | main_db.py |
| ã€ä¿®å¤ã€‘å®‰è£…ä¾èµ–åˆ°venv.bat | å®‰è£…Pythonä¾èµ– | - |
| ã€å®‰è£…ã€‘MySQLæ•°æ®åº“ä¾èµ–.bat | å®‰è£…æ•°æ®åº“ä¾èµ– | - |
| ã€æµ‹è¯•ã€‘æ•°æ®åº“è¿æ¥.bat | æµ‹è¯•æ•°æ®åº“è¿æ¥ | database.py |
| ã€æµ‹è¯•ã€‘ç”¨æˆ·è®¤è¯.bat | æµ‹è¯•JWTè®¤è¯ | auth_api.py |
| ã€æ‰§è¡Œã€‘æ•°æ®è¿ç§»-ç®€åŒ–ç‰ˆ.bat | æ•°æ®è¿ç§» | migrate_data.py |

---

## ğŸ”„ æ•°æ®è¿ç§»æµç¨‹

```
JSONæ–‡ä»¶                    MySQLæ•°æ®åº“
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

mistakes.json        â†’      subjectè¡¨ï¼ˆsubject_type='mistake'ï¼‰
                             â†“
                            user_examè¡¨ï¼ˆå…³è”ç”¨æˆ·ï¼‰
                             â†“
                            examè¡¨ï¼ˆé”™é¢˜æœ¬è¯•å·ï¼‰

generated_questions.json â†’  subjectè¡¨ï¼ˆsubject_type='generated'ï¼‰
                             â†“
                            user_examè¡¨ï¼ˆå…³è”ç”¨æˆ·ï¼‰
                             â†“
                            examè¡¨ï¼ˆç»ƒä¹ é¢˜é›†è¯•å·ï¼‰
```

---

## ğŸ§ª æµ‹è¯•è´¦å·ä¿¡æ¯

### demo_userï¼ˆé¢„è£…æ•°æ®ï¼‰
```
è´¦å·ï¼šdemo_user
å¯†ç ï¼šdemo123456
ç”¨æˆ·IDï¼š48fd341f-5917-4efa-a289-c3e3c854e251
é”™é¢˜æ•°ï¼š5æ¡
é¢˜ç›®æ•°ï¼š62æ¡
æ€»æ•°æ®ï¼š67æ¡
```

### åˆ›å»ºæ–°è´¦å·
1. è®¿é—® http://localhost:5173/?mode=db
2. ç‚¹å‡»"ç«‹å³æ³¨å†Œ"
3. å¡«å†™ä¿¡æ¯
4. è‡ªåŠ¨ç™»å½•

---

## ğŸ“¦ ä¾èµ–ç‰ˆæœ¬

### Pythonåç«¯
```txt
fastapi==0.104.1
uvicorn==0.24.0
python-multipart==0.0.6
python-dotenv==1.0.0
dashscope==1.14.1
pymysql==1.1.0
pyjwt==2.8.0
cryptography==41.0.7
pyppeteer==1.0.2
markdown==3.5.1
beautifulsoup4==4.12.2
requests==2.31.0
Pillow==10.1.0
```

### å‰ç«¯
```json
{
  "react": "^18.2.0",
  "react-dom": "^18.2.0",
  "typescript": "^5.2.2",
  "vite": "^5.0.0",
  "marked": "^9.1.6",
  "axios": "^1.6.2"
}
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### åç«¯å¯åŠ¨å¤±è´¥
1. æ£€æŸ¥Pythonè™šæ‹Ÿç¯å¢ƒæ˜¯å¦æ¿€æ´»
2. æ£€æŸ¥ä¾èµ–æ˜¯å¦å®Œæ•´å®‰è£…
3. æ£€æŸ¥ç«¯å£8000æ˜¯å¦è¢«å ç”¨
4. æŸ¥çœ‹ç»ˆç«¯é”™è¯¯ä¿¡æ¯

### æ•°æ®åº“è¿æ¥å¤±è´¥
1. æ£€æŸ¥æ•°æ®åº“æœåŠ¡å™¨æ˜¯å¦å¯è®¿é—®
2. æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
4. è¿è¡Œã€æµ‹è¯•ã€‘æ•°æ®åº“è¿æ¥.bat

### å‰ç«¯ç™»å½•å¤±è´¥
1. æ£€æŸ¥åç«¯æ˜¯å¦å¯åŠ¨
2. æ£€æŸ¥ç½‘ç»œè¯·æ±‚æ˜¯å¦æ­£å¸¸ï¼ˆF12æ§åˆ¶å°ï¼‰
3. æ£€æŸ¥è´¦å·å¯†ç æ˜¯å¦æ­£ç¡®
4. å°è¯•æ³¨å†Œæ–°è´¦å·

### JWTä»¤ç‰Œè¿‡æœŸ
1. é‡æ–°ç™»å½•
2. æ£€æŸ¥ç³»ç»Ÿæ—¶é—´æ˜¯å¦æ­£ç¡®
3. ä»¤ç‰Œæœ‰æ•ˆæœŸä¸º24å°æ—¶

---

## ğŸ“ è·å–å¸®åŠ©

### æ–‡æ¡£
- [V25.1_MySQLæ•°æ®åº“é›†æˆå®ŒæˆæŠ¥å‘Š.md](./V25.1_MySQLæ•°æ®åº“é›†æˆå®ŒæˆæŠ¥å‘Š.md)
- [V25.1_MySQLæ•°æ®åº“é›†æˆæŒ‡å—.md](./V25.1_MySQLæ•°æ®åº“é›†æˆæŒ‡å—.md)
- [ã€å¿…è¯»ã€‘V25.1æ•°æ®åº“ç‰ˆæœ¬å¿«é€Ÿå¯åŠ¨.md](./ã€å¿…è¯»ã€‘V25.1æ•°æ®åº“ç‰ˆæœ¬å¿«é€Ÿå¯åŠ¨.md)

### APIæ–‡æ¡£
- http://127.0.0.1:8000/docs ï¼ˆå¯åŠ¨åç«¯åè®¿é—®ï¼‰

### æ•°æ®åº“å·¥å…·
- Navicat Premiumï¼ˆæ¨èï¼‰
- MySQL Workbench
- phpMyAdmin

---

**ä¿å­˜æœ¬æ–‡æ¡£ï¼Œéšæ—¶æŸ¥é˜…ç³»ç»Ÿä¿¡æ¯ï¼** ğŸ“š

*æœ€åæ›´æ–°ï¼š2025å¹´10æœˆ25æ—¥ - V25.1*

